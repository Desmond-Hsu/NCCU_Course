n=10000; T=1; xi1=0.05; C=rep(0,n);
theta.m=c(16,64); theta.xi2=c(0.1,0.3); theta.K=c(45,50,55); theta=array(0,c(12,3)); a=0;
for (i in 1:2){
  for (j in 1:2){
    for (l in 1:3){
      a=a+1;
      theta[a,1]=theta.m[i];
      theta[a,2]=theta.xi2[j];
      theta[a,3]=theta.K[l];
    }
  }
}

for (q in 1:12){
  m=theta[q,1]; xi2=theta[q,2]; K=theta[q,3];
  delta=T/m; S=rep(0,m+1); S[1]=50;
  set.seed(2018)
  for (j in 1:n){
    for (i in 1:m){
      z=rnorm(1);  
      S[i+1]=S[i]*exp((xi1-xi2^2/2)*delta+xi2*sqrt(delta)*z)
    }
    C[j]=max(0,mean(S)-K)
  }
  v=exp(-2*xi1*T)*var(C)
  print(round(c(m,xi2,K,exp(-xi1*T)*mean(C),sqrt(v/n)),4))
}

#  results
# [1] 16.0000  0.1000 45.0000  6.0604  0.0281
# [1] 16.0000  0.1000 50.0000  1.8748  0.0213
# [1] 16.0000  0.1000 55.0000  0.1732  0.0065
# [1] 16.0000  0.3000 45.0000  7.1723  0.0744
# [1] 16.0000  0.3000 50.0000  4.1139  0.0608
# [1] 16.0000  0.3000 55.0000  2.1212  0.0453
# [1] 64.0000  0.1000 45.0000  6.0187  0.0281
# [1] 64.0000  0.1000 50.0000  1.8452  0.0213
# [1] 64.0000  0.1000 55.0000  0.1724  0.0066
# [1] 64.0000  0.3000 45.0000  7.0751  0.0743
# [1] 64.0000  0.3000 50.0000  4.0467  0.0608
# [1] 64.0000  0.3000 55.0000  2.0922  0.0453